\documentclass[11pt,a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}

\usepackage{amsmath,amssymb,amsfonts}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usepackage{tkz-graph}

\usepackage{graphicx}
\usepackage{hyperref}

\title{Advanced Algorithms\\Assignment 1}
\author{Kristoffer Søholm \and Sebastian Paaske Tørholm}

\begin{document}
\maketitle

\section{Exercise 1: $b$-flow}
We can express a $b$-flow problem as a max-flow problem. Let every vertex,
v, with positive demand get an edge from the source with capacity $b_v$, and
every vertex $v$ with negative demand get an edge to the sink with capacity
$-b_v$. If we in this network can get a maximum flow that maxes out all of both
the source and sink edges, we have a corresponding $b$-flow.
This, however, was not what we were asked about.

Figure $1(a)$ does have a $b$-flow, as can be seen in \autoref{fig-a-bflow}.

Figure $1(b)$ does not have one, since no flow can leave $v_4$, and thus it
cannot satisfy the requirement of $b_4 = -2$.

\begin{figure}[h!]
    \centering
    \begin{tikzpicture}[scale=1.75]
        \tikzset{EdgeStyle/.style={->}}

        \Vertex[x=0,y=3,L= 3,Math=true,LabelOut,Lpos=90]{D1}
        \Vertex[x=2,y=3,L=-2,Math=true,LabelOut,Lpos=90]{D2}
        \Vertex[x=0,y=1,L= 4,Math=true,LabelOut,Lpos=180]{D3}
        \Vertex[x=2,y=1,L= 2,Math=true,LabelOut,Lpos=0]{D4}
        \Vertex[x=1,y=0,L=-7,Math=true,LabelOut,Lpos=-90]{D5}

        \Vertex[x=0,y=3,L=v_1,Math=true]{V1}
        \Vertex[x=2,y=3,L=v_2,Math=true]{V2}
        \Vertex[x=0,y=1,L=v_3,Math=true]{V3}
        \Vertex[x=2,y=1,L=v_4,Math=true]{V4}
        \Vertex[x=1,y=0,L=v_5,Math=true]{V5}

        \Edge[label = $3/4$](V1)(V3)
        \Edge[label = $0/1$, style={pos=.25}](V1)(V4)
        \Edge[label = $0/5$](V2)(V1)
        \Edge[label = $2/2$](V2)(V4)
        \Edge[label = $0/4$, style={pos=.25}](V3)(V2)
        \Edge[label = $0/3$](V3)(V4)
        \Edge[label = $0/2$](V4)(V5)
        \Edge[label = $1/7$](V5)(V3)

        \tikzset{EdgeStyle/.append style = {bend left=75}}
        \Edge[label = $0/3$, style={pos=.40}](V2)(V5)
        \Edge[label = $6/6$, style={pos=.60}](V5)(V1)
    \end{tikzpicture}
    \caption{A $b$-flow for figure $1(a)$}
    \label{fig-a-bflow}
\end{figure}

\section{Exercise 2: Minimum-cost flow}
The following is a LP-formualtion in standard form for the MCFP instance from figure
$1(a)$ with the given cost function, where $x_{v_iv_j}$ represents the flow from vertex
$i$ to vertex $j$. To do this we found all the constraints and converted the problem to
standard form as we went along. Firstly, the capacity constraint gives us one constraint
per edge, and also that the flow is positive. The flow constraint then gives us a single
equality per vertex, which we converted to two inequalites. Finally we need to minimize
the cost function, which is the same as maximizing the negative cost-function.

\begin{align*}
    maximize &  
             & 
    s.t.     & \\
             &  x_{v_1v_3} &\leq 4 \\
             &  x_{v_1v_4} &\leq 1 \\
             &  x_{v_2v_1} &\leq 5 \\
             &  x_{v_2v_4} &\leq 2 \\
             &  x_{v_2v_5} &\leq 3 \\
             &  x_{v_3v_2} &\leq 4 \\
             &  x_{v_3v_4} &\leq 3 \\
             &  x_{v_4v_5} &\leq 2 \\
             &  x_{v_5v_1} &\leq 6 \\
             &  x_{v_5v_3} &\leq 7 \\
             &  x_{v_2v_1} + x_{v_5v_1} - x_{v_1v_3} - x_{v_1v_4}  &\leq 3 \\
             &  -x_{v_2v_1} - x_{v_5v_1} + x_{v_1v_3} + x_{v_1v_4} &\leq -3  \\
             &  x_{v_3v_2} - x_{v_2v_1} - x_{v_2v_4} - x_{v_2v_5}  &\leq -2 \\ 
             &  -x_{v_3v_2} + x_{v_2v_1} + x_{v_2v_4} + x_{v_2v_5} &\leq 2 \\ 
             &  -x_{v_3v_2} - x_{v_3v_4} + x_{v_1v_3} + x_{v_5v_3} &\leq 4 \\
             &  x_{v_3v_2} + x_{v_3v_4} - x_{v_1v_3} - x_{v_5v_3}  &\leq -4 \\
             &  -x_{v_4v_5} + x_{v_1v_4} + x_{v_2v_4} + x_{v_3v_4} &\leq 2 \\
             &  x_{v_4v_5} - x_{v_1v_4} - x_{v_2v_4} - x_{v_3v_4}  &\leq -2 \\
             &  x_{v_2v_5} + x_{v_4v_5} - x_{v_5v_1} - x_{v_5v_3}  &\leq -7 \\ 
             &  -x_{v_2v_5} - x_{v_4v_5} + x_{v_5v_1} + x_{v_5v_3} &\leq 8 \\
             &  x_{v_1v_3}, x_{v_1v_4}, x_{v_2v_1}, x_{v_2v_4}, x_{v_2v_5} &\geq 0\\
             &  x_{v_3v_2}, x_{v_3v_4}, x_{v_4v_5}, x_{v_5v_1}, x_{v_5v_3} &\geq 0
\end{align*}

The dual 

\begin{align*}
    minimize & - x_{v_1v_3} - 2x_{v_1v_4} - 3x_{v_2v_1} - 4x_{v_2v_4} - 5x_{v_2v_5} \\
             & -6x_{v_3v_2} - 7x_{v_3v_4} - 8x_{v_4v_5} - 9x_{v_5v_1} - 10x_{v_5v_3} \\
    s.t.     & \\
             &  x_{v_1v_3} &\geq 4 \\
             &  x_{v_1v_4} &\geq 1 \\
             &  x_{v_2v_1} &\geq 5 \\
             &  x_{v_2v_4} &\geq 2 \\
             &  x_{v_2v_5} &\geq 3 \\
             &  x_{v_3v_2} &\geq 4 \\
             &  x_{v_3v_4} &\geq 3 \\
             &  x_{v_4v_5} &\geq 2 \\
             &  x_{v_5v_1} &\geq 6 \\
             &  x_{v_5v_3} &\geq 7 \\
             &  x_{v_2v_1} + x_{v_5v_1} - x_{v_1v_3} - x_{v_1v_4}  &\geq 3 \\
             &  -x_{v_2v_1} - x_{v_5v_1} + x_{v_1v_3} + x_{v_1v_4} &\geq -3  \\
             &  x_{v_3v_2} - x_{v_2v_1} - x_{v_2v_4} - x_{v_2v_5}  &\geq -2 \\ 
             &  -x_{v_3v_2} + x_{v_2v_1} + x_{v_2v_4} + x_{v_2v_5} &\geq 2 \\ 
             &  -x_{v_3v_2} - x_{v_3v_4} + x_{v_1v_3} + x_{v_5v_3} &\geq 4 \\
             &  x_{v_3v_2} + x_{v_3v_4} - x_{v_1v_3} - x_{v_5v_3}  &\geq -4 \\
             &  -x_{v_4v_5} + x_{v_1v_4} + x_{v_2v_4} + x_{v_3v_4} &\geq 2 \\
             &  x_{v_4v_5} - x_{v_1v_4} - x_{v_2v_4} - x_{v_3v_4}  &\geq -2 \\
             &  x_{v_2v_5} + x_{v_4v_5} - x_{v_5v_1} - x_{v_5v_3}  &\geq -7 \\ 
             &  -x_{v_2v_5} - x_{v_4v_5} + x_{v_5v_1} + x_{v_5v_3} &\geq 8 \\
             &  x_{v_1v_3}, x_{v_1v_4}, x_{v_2v_1}, x_{v_2v_4}, x_{v_2v_5} &\geq 0\\
             &  x_{v_3v_2}, x_{v_3v_4}, x_{v_4v_5}, x_{v_5v_1}, x_{v_5v_3} &\geq 0
\end{align*}

\section{Exercise 3: Rectilinear planar embedding}

\subsection{Exercise 3.1}
$z_{fg}$ is given by
\begin{tabular}{|l||l|l|l|l|l|}
    \hline
     & $a$ & $b$ & $c$ & $d$ & $e$ \\
    \hline
    \hline
    $a$ & 0 & 0 & 0 & 0 & 0 \\
    $b$ & 2 & 0 & 1 & 1 & 0 \\
    $c$ & 1 & 1 & 0 & 0 & 0 \\
    $d$ & 0 & 1 & 0 & 0 & 2 \\
    $e$ & 4 & 0 & 0 & 0 & 0 \\
    \hline
\end{tabular}


$x_{vf}$ is given by
\begin{tabular}{|l||l|l|l|l|l|l|l|}
    \hline
     & $v_1$ & $v_2$ & $v_3$ & $v_4$ & $v_5$ & $v_6$ & $v_7$ \\
    \hline
    \hline
    $a$ & 0 & 0 & 1 &  0 &  1 & 1 & 0 \\
    $b$ & 1 & 0 & 0 &  0 &  0 & 1 & 0 \\
    $c$ & 1 & 1 & 1 &  0 &  0 & 0 & 0 \\
    $d$ & 0 & 1 & 1 & -1 &  0 & 1 & 0 \\
    $e$ & 0 & 0 & 1 &  1 & -1 & 1 & 0 \\
    \hline
\end{tabular}

There are 13 break points in total:
\begin{itemize}
    \item 2 on the edge $v_1v_6$
    \item 2 on the edge $v_1v_2$
    \item 2 on the edge $v_2v_6$
    \item 1 on the edge $v_6v_7$
    \item 1 on the edge $v_4v_6$
    \item 1 on the edge $v_5v_7$
    \item 1 on the edge $v_3v_4$
    \item 2 on the edge $v_5v_3$
    \item 0 on the edge $v_2v_3$
    \item 1 on the edge $v_1v_3$
\end{itemize}
% verify, please

% Eh, vi winger den
\includegraphics[width=0.5\textwidth]{images/rectilinear-2}

\end{document}

